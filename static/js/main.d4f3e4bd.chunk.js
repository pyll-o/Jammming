(this.webpackJsonpjammming_two=this.webpackJsonpjammming_two||[]).push([[0],[,,,,,,,,,function(e,a,t){e.exports=t(21)},,,,,function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){},function(e,a,t){"use strict";t.r(a);var n=t(0),s=t.n(n),r=t(7),c=t.n(r),i=(t(14),t(8)),o=t(2),l=t(3),h=t(1),u=t(5),d=t(4);t(15),t(16);function m(e){var a=e.searchPhrase,t=e.handleSearchChange,n=e.handleClick;return s.a.createElement("div",{className:"SearchBar"},s.a.createElement("input",{placeholder:"Enter A Song, Album, or Artist",value:a,onChange:t}),s.a.createElement("button",{className:"SearchButton",onClick:n},"SEARCH"))}t(17),t(18),t(19);function k(e){var a=e.track,t=e.isInPlaylist,n=e.handleClick;return s.a.createElement("div",{className:"Track"},s.a.createElement("div",{className:"Track-information"},s.a.createElement("h3",null,a.title),s.a.createElement("p",null,a.artist," | ",a.album)),s.a.createElement("button",{className:"Track-action",onClick:n},t?"-":"+"))}var p=function(e){Object(u.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).handleClick=n.handleClick.bind(Object(h.a)(n)),n}return Object(l.a)(t,[{key:"handleClick",value:function(){this.props.isInPlaylist?this.props.removeTrack(this.props.track):this.props.addTrack(this.props.track)}},{key:"render",value:function(){return s.a.createElement(k,{track:this.props.track,isInPlaylist:this.props.isInPlaylist,handleClick:this.handleClick})}}]),t}(s.a.Component);function f(e){var a=e.tracks,t=e.isInPlaylist,n=e.addTrack,r=e.removeTrack;return s.a.createElement("div",{className:"TrackList"},a.map((function(e){return s.a.createElement(p,{track:e,key:e.id,isInPlaylist:t,addTrack:n,removeTrack:r})})))}function y(e){var a=e.tracks,t=e.addTrack;return s.a.createElement("div",{className:"SearchResults"},s.a.createElement("h2",null,"Results"),s.a.createElement(f,{tracks:a,isInPlaylist:!1,addTrack:t}))}t(20);function v(e){var a=e.tracks,t=e.playlistName,n=e.handleListNameChange,r=e.removeTrack,c=e.handleClick;return s.a.createElement("div",{className:"Playlist"},s.a.createElement("input",{value:t,onChange:n}),s.a.createElement(f,{tracks:a,isInPlaylist:!0,removeTrack:r}),s.a.createElement("button",{className:"Playlist-save",onClick:c},"SAVE TO SPOTIFY"))}function T(e){var a=e.playlistTracks,t=e.searchTracks,n=e.searchPhrase,r=e.handleSearchChange,c=e.playlistName,i=e.handleListNameChange,o=e.addTrack,l=e.removeTrack,h=e.search,u=e.addPlaylist;return s.a.createElement("div",null,s.a.createElement("h1",null,"Ja",s.a.createElement("span",{className:"highlight"},"mmm"),"ing"),s.a.createElement("div",{className:"App"},s.a.createElement(m,{searchPhrase:n,handleSearchChange:r,handleClick:h}),s.a.createElement("div",{className:"App-playlist"},s.a.createElement(y,{tracks:t,addTrack:o}),s.a.createElement(v,{tracks:a,playlistName:c,handleListNameChange:i,removeTrack:l,handleClick:u}))))}var g={clientId:"20ad80ca3acb46a3ac4dfbfa29dfe2c7",accessToken:"",tokenExpiry:null,redirectURI:"https://pyll-o.github.io/Jammming",generateURLState:function(){sessionStorage.urlState=Math.floor(1e5*Math.random()).toString()},getAccessToken:function(){var e=this;window.location.href.match(/state=(\d+)/)[1]===sessionStorage.urlState&&(this.accessToken=window.location.href.match(/access_token=([^&]+)/)[1],this.tokenExpiry=window.location.href.match(/expires_in=([^&]+)/)[1],window.history.pushState("AccessToken",null,"/"),setTimeout((function(){return e.accessToken=""}),1e3*this.tokenExpiry))},getUserId:function(){return fetch("https://api.spotify.com/v1/me",{headers:{Authorization:"Bearer ".concat(this.accessToken)}}).then((function(e){if(e.ok)return e.json()})).then((function(e){return e.id}))},getUserPlaylists:function(){fetch("https://api.spotify.com/v1/me/playlists",{headers:{Authorization:"Bearer ".concat(this.accessToken)}}).then((function(e){if(e.ok)return e.json()})).then((function(e){return console.log(e)}))},createPlaylist:function(e,a){var t="https://api.spotify.com/v1/users/".concat(e,"/playlists"),n=JSON.stringify({name:a});return fetch(t,{method:"POST",headers:{Authorization:"Bearer ".concat(this.accessToken),"Content-Type":"application/json"},body:n}).then((function(e){if(e.ok)return e.json()}))},addPlaylist:function(e,a){var t=this;this.accessToken?this.getUserId().then((function(a){return t.createPlaylist(a,e)})).then((function(e){console.log(e);var n=e.id,s="https://api.spotify.com/v1/playlists/".concat(n,"/tracks"),r=JSON.stringify({uris:a});return fetch(s,{method:"POST",headers:{Authorization:"Bearer ".concat(t.accessToken),"Content-Type":"application/json"},body:r})})).then((function(e){if(e.ok)return e.json()})).then((function(e){return console.log(e)})):(this.generateURLState(),this.spotifyLogin(sessionStorage.urlState))},spotifyLogin:function(e){var a="https://accounts.spotify.com/authorize?client_id=".concat(this.clientId,"&response_type=token&redirect_uri=").concat(encodeURIComponent(this.redirectURI),"&state=").concat(e,"&scope=playlist-modify-public");return!this.accessToken&&(window.location.href=a,!0)},search:function(e){var a="https://api.spotify.com/v1/search?q=".concat(encodeURIComponent(e),"&type=track");return fetch(a,{headers:{Authorization:"Bearer ".concat(this.accessToken)}}).then((function(e){if(e.ok)return e.json()})).then((function(e){return e.tracks.items}))}},S=function(e){Object(u.a)(t,e);var a=Object(d.a)(t);function t(e){var n;return Object(o.a)(this,t),(n=a.call(this,e)).state={playlistTracks:[],searchPhrase:"",searchTracks:[],playlistName:"New Playlist"},n.handleSearchChange=n.handleSearchChange.bind(Object(h.a)(n)),n.handleListNameChange=n.handleListNameChange.bind(Object(h.a)(n)),n.addTrack=n.addTrack.bind(Object(h.a)(n)),n.removeTrack=n.removeTrack.bind(Object(h.a)(n)),n.search=n.search.bind(Object(h.a)(n)),n.handleSearchResponse=n.handleSearchResponse.bind(Object(h.a)(n)),n.addPlaylist=n.addPlaylist.bind(Object(h.a)(n)),n}return Object(l.a)(t,[{key:"handleSearchChange",value:function(e){var a=e.target;this.setState({searchPhrase:a.value})}},{key:"search",value:function(){var e=this;g.generateURLState(),sessionStorage.searchPhrase=this.state.searchPhrase,g.spotifyLogin(sessionStorage.urlState)||g.search(this.state.searchPhrase).then((function(a){return e.handleSearchResponse(a)}))}},{key:"handleSearchResponse",value:function(e){var a=e.map((function(e){return{title:e.name,artist:e.artists[0].name,album:e.album.name,id:e.id,URI:e.uri}}));this.setState({searchTracks:a,searchPhrase:""})}},{key:"handleListNameChange",value:function(e){var a=e.target;this.setState({playlistName:a.value})}},{key:"addPlaylist",value:function(){var e=this.state.playlistTracks.map((function(e){return e.URI}));g.addPlaylist(this.state.playlistName,e)}},{key:"addTrack",value:function(e){this.state.playlistTracks.map((function(e){return e.id})).includes(e.id)||this.setState((function(a){return{playlistTracks:[].concat(Object(i.a)(a.playlistTracks),[e])}}))}},{key:"removeTrack",value:function(e){var a=this.state.playlistTracks.filter((function(a){return a.id!==e.id}));this.setState({playlistTracks:a})}},{key:"render",value:function(){return s.a.createElement(T,{playlistTracks:this.state.playlistTracks,searchTracks:this.state.searchTracks,searchPhrase:this.state.searchPhrase,handleSearchChange:this.handleSearchChange,playlistName:this.state.playlistName,handleListNameChange:this.handleListNameChange,addTrack:this.addTrack,removeTrack:this.removeTrack,search:this.search,addPlaylist:this.addPlaylist})}},{key:"componentDidMount",value:function(){var e=this;window.location.href.match(/access_token=/)&&(g.getAccessToken(),this.setState({searchPhrase:sessionStorage.searchPhrase},(function(){e.state.searchPhrase&&g.search(e.state.searchPhrase).then((function(a){return e.handleSearchResponse(a)}))})))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[9,1,2]]]);
//# sourceMappingURL=main.d4f3e4bd.chunk.js.map